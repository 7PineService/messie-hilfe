!function(e=!1){if("undefined"==typeof window)return;if(!window.dataLayer)return void(e&&console.warn("[Tracking] dataLayer not available - tracking disabled"));const n=new WeakSet;function t(t){n.has(t)||(n.add(t),e&&console.log("[Tracking] Setting up phone link:",t.href),t.addEventListener("click",function(){e&&console.log("[Tracking] Phone link clicked:",t.href);let n=!1;const o=function(){n||!document.hidden&&"hidden"!==document.visibilityState?e&&!n&&console.log("[Tracking] Page visibility changed but still visible - waiting..."):(n=!0,e&&(console.log("[Tracking] ✅ Phone call event fired - page visibility changed"),console.log("[Tracking] Event data:",{event:"contact_call",href:t.href})),window.dataLayer.push({event:"contact_call"}),c())},a=function(){n||(n=!0,e&&(console.log("[Tracking] ✅ Phone call event fired - pagehide/blur fallback"),console.log("[Tracking] Event data:",{event:"contact_call",href:t.href})),window.dataLayer.push({event:"contact_call"}),c())};function c(){document.removeEventListener("visibilitychange",o),window.removeEventListener("pagehide",a),window.removeEventListener("blur",a),e&&console.log("[Tracking] Phone call listeners removed")}document.addEventListener("visibilitychange",o),window.addEventListener("pagehide",a),window.addEventListener("blur",a),setTimeout(function(){n||(n=!0,e&&(console.log("[Tracking] ✅ Phone call event fired - dialer launch detected (fallback)"),console.log("[Tracking] Event data:",{event:"contact_call",href:t.href})),window.dataLayer.push({event:"contact_call"}),c())},300),setTimeout(function(){n||e&&console.log("[Tracking] Phone call listener timeout - removed after 5s (no event fired)"),c()},5e3)}))}function o(t){n.has(t)||(n.add(t),e&&console.log("[Tracking] Setting up WhatsApp link:",t.href),t.addEventListener("click",function(){e&&console.log("[Tracking] WhatsApp link clicked:",t.href);const n=function(){document.hasFocus()?e&&console.log("[Tracking] Window blur detected but still has focus - waiting..."):(e&&(console.log("[Tracking] ✅ WhatsApp event fired - window lost focus"),console.log("[Tracking] Event data:",{event:"contact_whatsapp",href:t.href})),window.dataLayer.push({event:"contact_whatsapp"}),window.removeEventListener("blur",n),e&&console.log("[Tracking] WhatsApp listener removed"))};window.addEventListener("blur",n),setTimeout(function(){window.removeEventListener("blur",n),e&&console.log("[Tracking] WhatsApp listener timeout - removed after 5s")},5e3)}))}function a(t){t&&!n.has(t)&&(n.add(t),t.addEventListener("click",function(){e&&(console.log("[Tracking] CTA clicked:",t.getAttribute("data-cta")),console.log("[Tracking] ✅ Firing cta_click event"),console.log("[Tracking] Event data:",{event:"cta_click",cta_type:"primary"})),window.dataLayer&&window.dataLayer.push({event:"cta_click",cta_type:"primary"})}))}function c(){e&&console.log("[Tracking] Initializing event tracking hooks...");const n=document.querySelectorAll('a[href^="tel:"]');e&&console.log(`[Tracking] Found ${n.length} phone link(s)`),n.forEach(e=>t(e));const c=document.querySelectorAll('a[href*="wa.me"], a[href*="api.whatsapp.com"]');e&&console.log(`[Tracking] Found ${c.length} WhatsApp link(s)`),c.forEach(e=>o(e));const i=document.querySelectorAll("[data-cta]");e&&console.log(`[Tracking] Found ${i.length} CTA element(s)`),i.forEach(e=>a(e)),function(){let n,t=!1;function o(){if(t)return;const n=window.innerHeight,a=document.documentElement.scrollHeight;((window.pageYOffset||document.documentElement.scrollTop)+n)/a*100>=75&&(t=!0,e&&(console.log("[Tracking] ✅ Firing scroll_depth event"),console.log("[Tracking] Event data:",{event:"scroll_depth",percent:75})),window.dataLayer&&window.dataLayer.push({event:"scroll_depth",percent:75}),window.removeEventListener("scroll",o),e&&console.log("[Tracking] Scroll depth listener removed"))}window.addEventListener("scroll",function(){n&&window.cancelAnimationFrame(n),n=window.requestAnimationFrame(o)},{passive:!0}),e&&console.log("[Tracking] Scroll depth tracking initialized")}(),e&&console.log("[Tracking] Event tracking hooks initialized successfully")}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",c):c();const i=new MutationObserver(function(e){e.forEach(function(e){e.addedNodes.forEach(function(e){if(1===e.nodeType){const n=e;if("A"===n.tagName&&n.href){const e=n;e.href.startsWith("tel:")&&t(e),(e.href.includes("wa.me")||e.href.includes("api.whatsapp.com"))&&o(e)}n.hasAttribute&&n.hasAttribute("data-cta")&&a(n);const c=n.querySelectorAll&&n.querySelectorAll('a[href^="tel:"]');c&&c.forEach(e=>t(e));const i=n.querySelectorAll&&n.querySelectorAll('a[href*="wa.me"], a[href*="api.whatsapp.com"]');i&&i.forEach(e=>o(e));const l=n.querySelectorAll&&n.querySelectorAll("[data-cta]");l&&l.forEach(e=>a(e))}})})});function l(){i.observe(document.body,{childList:!0,subtree:!0}),e&&console.log("[Tracking] MutationObserver started - watching for dynamically added links")}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",l):l()}(!1);