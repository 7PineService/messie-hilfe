---
import { cn } from '@/utils/cn'
import { Image } from 'astro:assets'
import { Checkmark } from '@/components/icons'
import type { ImageMetadata } from 'astro'

type CardVariant = 'featured' | 'standard'

interface FeaturedCardProps {
  variant: 'featured'
  title: string
  description: string[]
  leftImage: ImageMetadata
  rightImage: ImageMetadata
  classes?: string
}

interface StandardCardProps {
  variant: 'standard'
  title: string
  description: string[]
  image: ImageMetadata
  classes?: string
}

type Props = FeaturedCardProps | StandardCardProps

const props = Astro.props
const { variant, title, description, classes } = props

const isFeatured = variant === 'featured'
const leftImage = isFeatured ? (props as FeaturedCardProps).leftImage : (props as StandardCardProps).image
const rightImage = isFeatured ? (props as FeaturedCardProps).rightImage : undefined
---

<>
  <div
    class={cn(
      classes,
      'cost-card relative hidden md:flex gap-2 transition rounded-xl shadow-lg',
      isFeatured ? 'items-center' : ''
    )}
  >
    <div
      class={cn(
        'flex items-center lg:max-w-[24%] max-w-[30%]',
      )}
    >
      <Image
        src={leftImage}
        alt={title}
        loading="eager"
        decoding="async"
        class="w-auto mx-auto object-contain scale-120 translate-x-2"
      />
    </div>

    <div class={cn(
      'flex flex-col justify-center flex-1 px-4 py-4 lg:py-6'
    )}>
      <h4
        class={cn(
          isFeatured
            ? 'text-sm min-[426px]:text-base sm:text-xl md:text-2xl lg:text-3lg xl:text-4xl'
            : 'text-xs min-[426px]:text-sm sm:text-lg md:text-xl lg:text-lg xl:text-xl 2xl:text-2xl min-[1920px]:text-3xl',
          'font-semibold leading-tight mb-2 lg:mb-4'
        )}
      >
        {title}
      </h4>
      <div
        class={cn(
          isFeatured
            ? 'text-[10px] min-[426px]:text-sm sm:text-base md:text-lg 2xl:text-xl min-[1920px]:text-2xl'
            : 'text-[10px] min-[426px]:text-xs sm:text-sm md:text-base 2xl:text-lg min-[1920px]:text-xl',
          'opacity-80 leading-relaxed'
        )}
      >
        {
          description.map((item) => (
            <div class="w-fit relative flex gap-1 sm:mb-1 lg:mb-2">
              <Checkmark
                size="sm"
                class="shrink-0 text-accent-bronze opacity-70 mr-1"
                aria-hidden={true}
              />
              {item}
            </div>
          ))
        }
      </div>
    </div>

    {
      rightImage && (
        <div class="lg:max-w-[24%] flex items-center">
          <Image
            src={rightImage}
            alt={title}
            loading="eager"
            decoding="async"
            class="hidden lg:block w-auto mx-auto object-contain"
          />
        </div>
      )
    }
  </div>

  <div
    class="cost-card-mobile md:hidden grid grid-cols-6 transition rounded-lg p-0"
  >
    <div
      class="card-img relative col-span-2 flex justify-center transition rounded-l-lg"
    >
      <Image
        class="object-contain scale-120 min-[426px]:scale-100"
        src={leftImage}
        alt={title}
        loading="eager"
        decoding="async"
      />
    </div>
    <div class="col-span-4 flex flex-col items-start gap-2 p-2 sm:p-4">
      <h4
        class="text-sm sm:text-lg md:text-xl font-semibold leading-tight sm:mb-2"
      >
        {title}
      </h4>
      <div
        class="text-[10px] sm:text-sm sm:tracking-normal opacity-80 leading-relaxed"
      >
        {
          description.map((item) => (
            <div class="w-fit relative flex gap-1 sm:mb-1 lg:mb-2">
              <Checkmark
                size="xs"
                class="shrink-0 text-accent-bronze opacity-70"
                aria-hidden={true}
              />
              {item}
            </div>
          ))
        }
      </div>
    </div>
  </div>
</>

<style>
  .cost-card {
    background: var(--color-surface-light-peach);
  }

  .cost-card:hover {
    background: var(--color-surface-warm-peach);
    box-shadow:
      var(--color-shadow-warm) 1px 0px 2px 2px,
      var(--color-shadow-warm) -7px 0px 2px -4px,
      var(--color-shadow-warm) 1px 2px 2px 2px;
  }

  .cost-card-mobile {
    background: var(--color-surface-light-peach);
    box-shadow: var(--color-shadow-subtle) 0px 2px 8px 0px;
  }

  .cost-card-mobile > .card-img {
    background: var(--color-surface-gradient-light);
  }

  .cost-card-mobile:hover {
    background: var(--color-surface-warm-peach);
    box-shadow:
      var(--color-shadow-warm) 1px 0px 2px 2px,
      var(--color-shadow-warm) -7px 0px 2px -4px,
      var(--color-shadow-warm) 1px 2px 2px 2px;
    z-index: 1;
  }

  .cost-card-mobile:hover > .card-img {
    background: var(--color-surface-gradient-warm);
  }
</style>
