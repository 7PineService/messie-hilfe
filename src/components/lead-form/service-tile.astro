---
import { Image } from 'astro:assets';
import type { ImageMetadata } from 'astro';
import { cn } from '@/utils/cn';

interface Props {
	name: string;
	value: string;
	label: string;
	icon?: ImageMetadata;
	selected?: boolean;
	multiSelect?: boolean;
	disabled?: boolean;
	class?: string;
	[key: string]: any;
}

const {
	name,
	value,
	label,
	icon,
	selected = false,
	multiSelect = true,
	disabled = false,
	class: className = '',
	...rest
} = Astro.props;

const inputType = multiSelect ? 'checkbox' : 'radio';

const baseClasses = 'service-tile relative flex items-center gap-1 rounded-lg cursor-pointer transition border';
const defaultClasses = '';
const selectedClasses = '';
const disabledClasses = 'opacity-50 cursor-not-allowed';
---

<label
	class={cn(
		baseClasses,
		selected ? selectedClasses : defaultClasses,
		disabled && disabledClasses,
		className
	)}
	data-tile-label
	{...rest}
>
	<input
		type={inputType}
		name={multiSelect ? `${name}[]` : name}
		value={value}
		checked={selected}
		disabled={disabled}
		class="sr-only"
		data-tile-input
	/>
	{icon && (
		<Image
			src={icon}
			alt=""
			class="w-16 h-16 object-contain shrink-0"
			loading="eager"
		/>
	)}
	<span class="text-base font-semibold pr-4">{label}</span>
</label>

<style>
	.service-tile {
		background: var(--color-surface-light-peach);
		border-color: rgba(212, 186, 165, 0.3);
		box-shadow: 0 1px 3px rgba(99, 99, 99, 0.12);
	}

	.service-tile:hover {
		background: var(--color-surface-warm-peach);
		border-color: var(--color-cta-primary);
	}

	.service-tile:has(input:checked) {
		background: var(--color-surface-warm-peach);
		border-color: var(--color-cta-primary);
	}

	.service-tile:has(input:focus-visible) {
		outline: 2px solid var(--color-border-primary);
		outline-offset: 2px;
	}
</style>
